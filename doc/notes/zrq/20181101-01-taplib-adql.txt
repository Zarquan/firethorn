#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2018, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#  
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#

# -----------------------------------------------------
# Compile the Java CC grammar ..
#[user@desktop]

    copyname=zrq.final
    copyname=working.001
    copyname=working.002

    cp -r zrq.final "${copyname:?}"

    source "${HOME:?}/projects.settings"
    pushd "${EDINBURGH_PROJECTS:?}"
        pushd 'taplib'
            pushd "${copyname:?}"

                # Remove the outputs
                mvn -f adql-pom.xml clean

                # Compile the JavaCC grammar
                mvn -f adql-pom.xml javacc:javacc


# -----------------------------------------------------
# Compare the generated classes with their originals ..
#[user@desktop]


    srcdir=src/adql/parser
    gendir=target/generated-sources/javacc/adql/parser

    filename=ADQLParser
    filename=ADQLParserConstants
    filename=ADQLParserTokenManager

    filename=ParseException
    filename=SimpleCharStream
    filename=Token
    filename=TokenMgrError

    meld "${srcdir:?}/${filename}.orig" "${gendir:?}/${filename}.java"


#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2018, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#  
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#

##########################################################
#####         Notes on Testing fix for 1182          #####
##########################################################


## Create OSA-TAP service in ftpy

python3


import firethorn
import firethorn_utils.configurator as configur
ft = firethorn.Firethorn(endpoint="http://gillian:8080/firethorn")
ft.login(firethorn.config.adminuser, firethorn.config.adminpass, firethorn.config.admingroup)
configurator =  configur.Configurator(ft)
configurator.load_resources("/home/firethorn.py/firethorn/data/osa-tap.json")


Importing JDBC Schema: ATLASDR1
Importing JDBC Schema: ATLASDR2
Importing JDBC Schema: ATLASDR3
Importing JDBC Schema: ATLASDR4
Importing JDBC Schema: 2MASS
Importing JDBC Schema: 2XMM
Importing JDBC Schema: WISE
Importing JDBC Schema: VIKINGDR3
Importing JDBC Schema: VHSDR1
Importing JDBC Schema: MGC
Importing JDBC Schema: GLIMPSE
Importing JDBC Schema: FIRST
Importing JDBC Schema: DENIS
Importing JDBC Schema: VPHASDR3
Importing JDBC Schema: VVVDR4
ERROR:root:HTTP Error 404: 
Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/firethorn/models/base/base_object.py", line 90, in get_json
    with urllib.request.urlopen( req, data) as response:
  File "/usr/lib/python3.5/urllib/request.py", line 163, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.5/urllib/request.py", line 472, in open
    response = meth(req, response)
  File "/usr/lib/python3.5/urllib/request.py", line 582, in http_response
    'http', request, response, code, msg, hdrs)
  File "/usr/lib/python3.5/urllib/request.py", line 510, in error
    return self._call_chain(*args)
  File "/usr/lib/python3.5/urllib/request.py", line 444, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.5/urllib/request.py", line 590, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: 
ERROR:root:Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/firethorn/models/adql/adql_resource.py", line 112, in import_jdbc_schema
    response_json_list = json.loads(response.text)
  File "/usr/lib/python3.5/json/__init__.py", line 319, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.5/json/decoder.py", line 339, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.5/json/decoder.py", line 357, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
Importing JDBC Schema: SDSSDR7
Importing JDBC Schema: SDSSDR9
TAP Service available at: http://gillian:8080/firethorn/tap/376723/
	



## -----------------------------
## Test with ftpy


resource=ft.firethorn_engine.select_adql_resource_by_ident("http://gillian:8080/firethorn/adql/resource/376723")


#
# Create and run a query on the resource.




## Test 1: Test a query with an TINYINT column (filterID from table Filter)
## ---------------------------------------------------------------------------------------



query_str = "SELECT TOP 10 * FROM ATLASDR1.Filter"

query_obj = resource.create_query(
    query_str,
    "COMPLETED",
    None,
    3000000
    )


print(
    query_obj.table()
     )

{
  "depth": "PARTIAL",
  "resource": "http://gillian:8080/firethorn/adql/resource/568066",
  "query": "http://gillian:8080/firethorn/blue/query/567725",
  "name": "XX_MLASDAE2KDLKIAAAAFYLTZ2XTM",
  "parent": "http://gillian:8080/firethorn/adql/schema/568262",
  "text": null,
  "url": "http://gillian:8080/firethorn/adql/table/567939",
  "formats": {
    "datatable": "http://gillian:8080/firethorn/adql/table/567939/datatable",
    "votable": "http://gillian:8080/firethorn/adql/table/567939/votable"
  },
  "schema": "http://gillian:8080/firethorn/adql/schema/568262",
  "self": "http://gillian:8080/firethorn/adql/table/567939",
  "fullname": "temp.XX_MLASDAE2KDLKIAAAAFYLTZ2XTM",
  "type": "http://data.metagrid.co.uk/wfau/firethorn/types/entity/adql-table-1.0.json",
  "columns": "http://gillian:8080/firethorn/adql/table/567939/columns/select",
  "ident": "567939",
  "metadata": {
    "adql": {
      "status": "COMPLETED",
      "count": 10
    }
  },
  "modified": "2020-03-08T11:28:31.132",
  "created": "2020-03-08T11:28:31.132",
  "base": "http://gillian:8080/firethorn/jdbc/table/567938",
  "root": "http://gillian:8080/firethorn/jdbc/table/567938",
  "owner": "http://gillian:8080/firethorn/community-member/155"
}



py_table = query_obj.table().as_astropy()
Downloading http://gillian:8080/firethorn/adql/table/569661/votable
|=======================================================================================================================================================================| 5.1k/5.1k (100.00%)         0s


py_table.pprint()
filterID shortName      name                                                               description                                                           ...   vegaToAB    oneSecMLVg  isSectioned
-------- --------- -------------- ------------------------------------------------------------------------------------------------------------------------------ ... ------------ ------------ -----------
       0      NONE           NONE                                                                                                                           NONE ... -999999500.0 -999999500.0           0
       1         u         u_SDSS Sloan u filter: see  Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf ...         0.94 -999999500.0           0
       2         g         g_SDSS Sloan g filter: see  Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf ...        -0.08 -999999500.0           0
       3         r         r_SDSS Sloan r filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf) ...         0.17 -999999500.0           0
       4         i         i_SDSS Sloan i filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf) ...          0.4 -999999500.0           0
       5         z         z_SDSS Sloan z filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf) ...         0.57 -999999500.0           0
       6         B         B_JOHN                                                                                                               Johnson B filter ...       -0.044 -999999500.0           0
       7         V         V_JOHN                                                                                                               Johnson V filter ...       -0.163 -999999500.0           0
       8      BLNK OMEGACAM blank                                                                                         OMEGACAM blank filter (e.g. for darks) ... -999999500.0 -999999500.0           0
       9     vStrm         v_STRM                                                                                                                   Stroemgren v ... -999999500.0 -999999500.0           0

## VALID
## filterID values are printed correctly



## Check VOTable file

import requests
r = requests.get("http://gillian:8080/firethorn/adql/table/569661/votable")
r.text

"<?xml version='1.0' encoding='UTF-8'?><VOTABLE xmlns='http://www.ivoa.net/xml/VOTable/v1.3' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.ivoa.net/xml/VOTable/v1.3 http://www.ivoa.net/xml/VOTable/v1.3' version='1.3'><RESOURCE type='results'><INFO name='QUERY_STATUS' value='OK'></INFO><INFO name='link' value='http://gillian:8080/firethorn/adql/table/569661'/><TABLE ID='table.569661' name='XX_UYLIZCPW3VTLWAAAAFYLTZ74YA'><FIELD ID='column.569755' name='filterID' datatype='short' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569755'/></FIELD><FIELD ID='column.569757' name='shortName' datatype='char' arraysize='10' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569757'/></FIELD><FIELD ID='column.569759' name='name' datatype='char' arraysize='16' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569759'/></FIELD><FIELD ID='column.569761' name='description' datatype='char' arraysize='256' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569761'/></FIELD><FIELD ID='column.569763' name='cutOn' datatype='float' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569763'/></FIELD><FIELD ID='column.569765' name='cutOff' datatype='float' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569765'/></FIELD><FIELD ID='column.569767' name='aebv' datatype='float' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569767'/></FIELD><FIELD ID='column.569769' name='vegaToAB' datatype='float' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569769'/></FIELD><FIELD ID='column.569771' name='oneSecMLVg' datatype='float' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569771'/></FIELD><FIELD ID='column.569773' name='isSectioned' datatype='short' xtype='null'><LINK content-type='application/json' content-role='metadata' href='http://gillian:8080/firethorn/adql/column/569773'/></FIELD><DATA><TABLEDATA><TR><TD>0</TD><TD>NONE</TD><TD>NONE</TD><TD>NONE</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>1</TD><TD>u</TD><TD>u_SDSS</TD><TD>Sloan u filter: see  Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf</TD><TD>0.32690000534057617</TD><TD>0.3828999996185303</TD><TD>5.15500020980835</TD><TD>0.9399999976158142</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>2</TD><TD>g</TD><TD>g_SDSS</TD><TD>Sloan g filter: see  Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf</TD><TD>0.4092000126838684</TD><TD>0.5457000136375427</TD><TD>3.7929999828338623</TD><TD>-0.07999999821186066</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>3</TD><TD>r</TD><TD>r_SDSS</TD><TD>Sloan r filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf)</TD><TD>0.5546000003814697</TD><TD>0.6916999816894531</TD><TD>2.750999927520752</TD><TD>0.17000000178813934</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>4</TD><TD>i</TD><TD>i_SDSS</TD><TD>Sloan i filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf)</TD><TD>0.6949999928474426</TD><TD>0.8309999704360962</TD><TD>2.0859999656677246</TD><TD>0.4000000059604645</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>5</TD><TD>z</TD><TD>z_SDSS</TD><TD>Sloan z filter (see Tokunaga et al., 2002, PASP, 114, 180; http://www.astro-wise.org/~omegacam/documents/3110_user_manual.pdf)</TD><TD>0.8654999732971191</TD><TD>0.9605000019073486</TD><TD>1.4789999723434448</TD><TD>0.5699999928474426</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>6</TD><TD>B</TD><TD>B_JOHN</TD><TD>Johnson B filter</TD><TD>0.38999998569488525</TD><TD>0.49000000953674316</TD><TD>-9.99999488E8</TD><TD>-0.04399999976158142</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>7</TD><TD>V</TD><TD>V_JOHN</TD><TD>Johnson V filter</TD><TD>0.5</TD><TD>0.6000000238418579</TD><TD>-9.99999488E8</TD><TD>-0.16300000250339508</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>8</TD><TD>BLNK</TD><TD>OMEGACAM blank</TD><TD>OMEGACAM blank filter (e.g. for darks)</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>0</TD></TR><TR><TD>9</TD><TD>vStrm</TD><TD>v_STRM</TD><TD>Stroemgren v</TD><TD>0.40049999952316284</TD><TD>0.42149999737739563</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>-9.99999488E8</TD><TD>0</TD></TR></TABLEDATA></DATA></TABLE></RESOURCE></VOTABLE>"



## name='filterID' datatype='short'
## This looks ok to me





## Test 2: Test column of type BYTE (array)
## ---------------------------------------------------------------------------------------


## Test with a TAP sync query:

curl -L "http://localhost:8080/firethorn/tap/376723/sync?QUERY=SELECT+TOP+5+img+FROM+BestDR7.SpecObjAll&REQUEST=doQuery&LANG=ADQL&FORMAT=VOTABLE"


<VOTABLE xmlns="http://www.ivoa.net/xml/VOTable/v1.3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.ivoa.net/xml/VOTable/v1.3 http://www.ivoa.net/xml/VOTable/v1.3" version="1.3">
<RESOURCE type="results">
<INFO name="QUERY_STATUS" value="OK"/>
<INFO name="link" value="http://localhost:8080/firethorn/adql/table/645873"/>
<TABLE ID="table.645873" name="XX_LNF44QUELOQQWAAAAFYLT6RCFM">
<FIELD ID="column.648345" name="img" datatype="unsignedByte" arraysize="8000" xtype="null">
<LINK content-type="application/json" content-role="metadata" href="http://localhost:8080/firethorn/adql/column/648345"/>
</FIELD>
<DATA>
<TABLEDATA>
<TR>
<TD>
71 73 70 56 55 97 82 3 168 2 162 0 0 255 255 255 0 0 0 255 0 0 0 255 0 0 0 255 0 255 255 255 0 255 255 255 0 44 0 0 0 0 82 3 168 2 0 3 254 8 186 220 254 48 202 73 171 189 56 235 205 187 255 96 40 142 100 105 158 104 170 174 108 235 190 112 44 207 116 109 223 120 174 239 124 239 255 192 160 112 72 44 26 143 200 164 114 201 108 58 159 208 168 116 74 173 90 175 216 172 118 203 237 122 191 224 176 120 76 46 155 207 232 180 122 205 110 187 223 240 184 124 78 175 219 239 248 188 126 207 239 251 255 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 46 1 205 155 1 210 210 16 207 30 214 17 216 13 212 217 211 222 14 218 15 225 0 223 226 28 222 227 232 211 12 235 44 227 226 239 236 213 224 234 244 27 241 239 216 232 231 245 224 221 213 248 184 101 216 183 173 66 60 19 237 224 1 188 167 238 153 192 131 58 32 66 131 162 77 224 2 137 20 32 90 84 192 254 13 163 188 130 255 62 114 52 119 79 228 200 108 23 87 108 36 185 146 35 190 9 225 58 122 52 73 243 36 185 154 6 51 230 179 22 147 231 54 125 26 42 86 204 233 238 98 79 155 41 201 205 76 74 242 102 144 150 19 165 164 147 183 244 231 65 135 32 153 194 180 138 114 104 86 165 85 105 122 109 234 242 4 53 137 49 253 245 132 170 117 234 133 149 45 129 178 11 171 17 235 87 167 120 145 166 197 224 54 47 74 149 254 144 230 29 107 193 99 216 23 103 163 98 233 123 243 48 78 167 123 131 146 253 72 88 176 223 183 129 47 107 181 76 2 237 93 159 147 63 103 54 152 46 223 102 205 18 12 143 22 189 153 110 102 213 128 179 106 188 70 244 169 226 43 145 71 58 62 125 114 108 213 151 44 83 135 46 252 122 94 140 217 172 129 195 171 140 122 222 209 226 171 97 18 140 14 186 166 114 204 178 231 38 6 43 52 97 103 202 129 217 10 55 206 189 180 69 135 226 69 236 190 45 164 161 200 238 238 163 227 29 122 118 230 117 166 200 239 98 127 95 142 179 254 246 248 37 253 101 146 92 242 101 167 159 112 244 53 101 90 121 253 248 181 160 118 74 89 71 222 126 122 181 69 96 133 46 53 148 222 104 235 156 7 89 80 253 217 36 84 91 70 89 5 96 7 235 177 7 196 133 34 162 200 225 92 7 198 120 25 115 188 53 183 149 129 5 242 165 97 92 227 189 247 24 108 140 101 212 226 131 15 158 67 29 142 188 57 214 96 139 62 138 85 66 110 243 209 216 35 116 248 241 135 152 138 84 176 120 34 95 38 18 20 228 112 130 237 152 227 110 125 221 215 66 126 73 137 41 35 120 107 134 215 27 134 154 165 56 227 106 44 206 25 160 113 101 254 23 34 8 95 86 87 227 132 72 66 214 160 156 3 97 57 5 97 145 237 88 228 100 80 230 104 99 156 83 114 25 168 132 25 110 41 169 128 254 153 25 92 155 217 129 230 219 107 138 70 106 103 149 148 222 185 105 147 254 49 56 221 141 250 105 121 41 149 111 2 170 170 119 70 26 26 69 162 156 202 202 218 159 169 62 250 101 174 140 62 54 170 89 172 102 10 104 158 192 14 254 25 43 147 194 134 182 168 131 173 37 11 38 179 212 66 27 194 125 136 22 74 30 174 164 58 99 235 173 32 61 91 155 172 23 110 228 89 164 24 149 38 100 180 2 110 248 193 115 221 22 200 88 110 35 78 41 151 76 22 74 86 35 145 129 94 149 174 189 25 58 217 235 171 176 46 91 150 168 248 241 180 151 148 40 16 250 45 14 83 137 187 46 166 70 53 122 46 166 26 202 151 238 158 179 66 88 84 171 226 105 202 49 119 63 21 91 238 90 238 2 196 86 64 59 161 28 226 191 20 119 84 114 197 234 109 73 107 137 51 83 236 35 84 230 194 224 240 195 177 252 172 135 208 91 16 141 27 208 72 47 145 114 33 70 103 177 244 24 77 39 45 245 212 84 87 109 245 213 88 103 173 245 214 92 119 237 245 215 96 135 45 246 216 100 151 109 246 217 104 167 173 246 218 108 183 237 246 219 112 199 45 247 220 116 215 109 247 221 120 231 173 247 222 124 247 237 247 223 128 7 46 248 224 132 23 110 248 225 136 39 174 248 226 140 55 238 248 227 144 71 46 249 228 148 254 87 110 249 229 152 103 174 249 230 156 119 238 249 231 160 135 46 250 232 164 151 110 250 233 168 167 174 250 234 172 183 238 250 235 176 199 46 251 236 180 215 46 138 162 184 231 174 251 238 188 247 238 251 239 192 7 47 252 240 196 23 111 252 241 200 39 175 252 242 204 55 239 252 243 208 71 47 253 244 191 67 242 52 194 250 19


....


212 218 181 209 172 223 64 204 223 124 252 56 85 106 179 253 45 178 234 93 168 211 124 224 6 250 83 243 77 91 81 221 224 77 157 211 55 154 213 204 61 225 210 61 224 80 202 208 167 42 210 69 29 186 40 139 205 31 94 159 62 29 198 94 109 127 248 70 180 110 221 223 195 181 92 98 173 226 209 125 177 109 122 227 200 157 227 241 187 49 227 162 221 227 253 251 227 154 141 214 84 75 164 169 61 228 73 174 228 75 206 228 77 238 228 79 14 229 81 46 229 83 78 229 85 110 229 87 142 229 89 174 229 91 206 229 135 147 0 0 59
</TD>
</TR>
</TABLEDATA>
</DATA>
</TABLE>
</RESOURCE>
</VOTABLE>



## VALID
## Column printed as Space-delimited byte array
## Column Type in VOTable: name="img" datatype="unsignedByte"







## Test3: Validate with Taplint
## ---------------------------------------------------------------------------------------

java -jar stilts.jar taplint tapurl=http://localhost:8080/firethorn/tap/376723/  debug=true
This is STILTS taplint, 3.2/1c07f08 (2019-11-18)
Static report types: ERROR(139), WARNING(56), INFO(23), SUMMARY(9), FAILURE(22)

Section TMV: Validate table metadata against XML schema
I-TMV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/tables as tableset (http://www.ivoa.net/xml/VODataService/v1.1)
S-TMV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section TME: Check content of tables metadata from /tables
I-TME-CURL-1 Reading capability metadata from http://localhost:8080/firethorn/tap/376723/capabilities
I-TME-TURL-1 Reading table metadata from http://localhost:8080/firethorn/tap/376723/tables
S-TME-SUMM-1 Schemas: 17, Tables: 739, Columns: 31211, Foreign Keys: 0
S-TME-FLGS-1 Standard column flags: indexed: 0, primary: 0, nullable: 0
S-TME-FLGO-1 Other column flags: none

Section TMS: Check content of tables metadata from TAP_SCHEMA
I-TMS-TAPV-1 Validating for TAP version V1.0
I-TMS-QSUB-1 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.schemas
I-TMS-QGET-1 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.schemas
I-TMS-QSUB-2 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.tables
I-TMS-QGET-2 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.tables
I-TMS-QSUB-3 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.columns
I-TMS-QGET-3 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.columns
I-TMS-QSUB-4 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.keys
I-TMS-QGET-4 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.keys
I-TMS-QSUB-5 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.key_columns
I-TMS-QGET-5 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.key_columns
I-TMS-QSUB-6 Submitting query: SELECT principal, indexed, std, "size" FROM TAP_SCHEMA.columns
I-TMS-QGET-6 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+principal%2C+indexed%2C+std%2C+%22size%22+FROM+TAP_SCHEMA.columns&MAXREC=31221
I-TMS-QSUB-7 Submitting query: SELECT TOP 1 * FROM TAP_SCHEMA.columns
I-TMS-QGET-7 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+1+*+FROM+TAP_SCHEMA.columns&MAXREC=1
I-TMS-QSUB-8 Submitting query: SELECT ft_column_id, std, indexed, principal, arraysize, ts_column_id, datatype, utype, ucd, unit, description, column_name, table_name FROM TAP_SCHEMA.columns
I-TMS-QGET-8 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+ft_column_id%2C+std%2C+indexed%2C+principal%2C+arraysize%2C+ts_column_id%2C+datatype%2C+utype%2C+ucd%2C+unit%2C+description%2C+column_name%2C+table_name+FROM+TAP_SCHEMA.columns&MAXREC=31221
I-TMS-QSUB-9 Submitting query: SELECT from_column, target_column, key_id FROM TAP_SCHEMA.key_columns
I-TMS-QGET-9 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+from_column%2C+target_column%2C+key_id+FROM+TAP_SCHEMA.key_columns&MAXREC=31221
E-TMS-TSCT-1 Type mismatch for column TAP_SCHEMA.schemas.schema_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-2 Type mismatch for column TAP_SCHEMA.schemas.utype: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-3 Type mismatch for column TAP_SCHEMA.schemas.description: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-1 2 non-standard columns in TAP_SCHEMA.schemas: [ts_schema_id, ft_schema_id]
E-TMS-TSCT-4 Type mismatch for column TAP_SCHEMA.tables.schema_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-5 Type mismatch for column TAP_SCHEMA.tables.table_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-6 Type mismatch for column TAP_SCHEMA.tables.table_type: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-7 Type mismatch for column TAP_SCHEMA.tables.utype: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-8 Type mismatch for column TAP_SCHEMA.tables.description: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-2 2 non-standard columns in TAP_SCHEMA.tables: [ts_table_id, ft_table_id]
E-TMS-TSCT-9 Type mismatch for column TAP_SCHEMA.columns.table_name: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-3 3 non-standard columns in TAP_SCHEMA.columns: [arraysize, ts_column_id, ft_column_id]
I-TMS-TSNS-4 1 non-standard columns in TAP_SCHEMA.keys: [ts_key_id]
I-TMS-TSNS-5 1 non-standard columns in TAP_SCHEMA.key_columns: [ts_key_column_id]
S-TMS-SUMM-1 Schemas: 17, Tables: 739, Columns: 31211, Foreign Keys: 0
S-TMS-FLGS-1 Standard column flags: indexed: 0, principal: 7, std: 33
S-TMS-QNUM-1 Successful/submitted TAP queries: 29/29
S-TMS-QTIM-1 Average successful query time: 1.5s
I-TMS-QSUB-x (20 more)
I-TMS-QGET-x (20 more)
E-TMS-TSCT-x (18 more)

Section TMC: Compare table metadata from /tables and TAP_SCHEMA

Section CPV: Validate capabilities against XML schema
I-CPV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/capabilities as capabilities (http://www.ivoa.net/xml/VOSICapabilities/v1.0)
S-CPV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section CAP: Check TAP and TAPRegExt content of capabilities document

Section AVV: Validate availability against XML schema
I-AVV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/availability as availability (http://www.ivoa.net/xml/VOSIAvailability/v1.0)
S-AVV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section QGE: Make ADQL queries in sync GET mode
I-QGE-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-1 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+10+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-2 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+programmeID+FROM+VPHASDR3.RequiredFilters&MAXREC=9
I-QGE-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-3 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+10+programmeID+FROM+VPHASDR3.RequiredFilters&DUMMY=ignore-me
I-QGE-QSUB-4 Submitting query: SELECT TOP 1 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-4 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL-2.0&QUERY=SELECT+TOP+1+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-5 Submitting query: SELECT TOP 1 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-5 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+1+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-6 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QGE-QGET-6 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+8+aperture%2C+transFile+AS+taplint_c_2%2C+V.surveyID%2C+tableID+AS+taplint_c_4%2C+programmeID++FROM+VPHASDR3.RequiredListDrivenProduct+AS+V
I-QGE-QSUB-7 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QGE-QGET-7 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+fieldID+FROM+VPHASDR3.StdFieldInfo&MAXREC=0
I-QGE-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QGE-QGET-8 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=DUFF+QUERY
I-QGE-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
I-QGE-QGET-9 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=OOBLECK&QUERY=SELECT+TOP+1+*+FROM+TAP_SCHEMA.tables
S-QGE-QNUM-1 Successful/submitted TAP queries: 7/7
S-QGE-QTIM-1 Average successful query time: 1.1s

Section QPO: Make ADQL queries in sync POST mode
I-QPO-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-4 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QPO-QSUB-5 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QPO-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QPO-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
S-QPO-QNUM-1 Successful/submitted TAP queries: 5/5
S-QPO-QTIM-1 Average successful query time: 1.1s

Section QAS: Make ADQL queries in async mode
I-QAS-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-1 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517406
I-QAS-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-2 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517407
E-QAS-OVNO-1 Overflow not marked - no <INFO name='QUERY_STATUS' value='OVERFLOW'/> after TABLE
I-QAS-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-3 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517408
I-QAS-QSUB-4 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QAS-QJOB-4 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517409
I-QAS-QSUB-5 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QAS-QJOB-5 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517410
I-QAS-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QAS-QJOB-6 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517411
I-QAS-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
I-QAS-QJOB-7 Submitted query at http://localhost:8080/firethorn/tap/376723/async/517412
E-QAS-DSUC-1 Apparent success from bad query (unknown query language)
S-QAS-QNUM-1 Successful/submitted TAP queries: 5/5
S-QAS-QTIM-1 Average successful query time: 1.4s

Section UWS: Test asynchronous UWS/TAP behaviour
I-UWS-CJOB-1 Created new job http://localhost:8080/firethorn/tap/376723/async/517413
I-UWS-POPA-1 POSTed runId=TAPLINT-002 to http://localhost:8080/firethorn/tap/376723/async/517413/parameters
I-UWS-POPA-2 POSTed PHASE=ABORT to http://localhost:8080/firethorn/tap/376723/async/517413/phase
I-UWS-POPA-3 POSTed ACTION=DELETE to http://localhost:8080/firethorn/tap/376723/async/517413
I-UWS-CJOB-2 Created new job http://localhost:8080/firethorn/tap/376723/async/517414
I-UWS-CJOB-3 Created new job http://localhost:8080/firethorn/tap/376723/async/517415
I-UWS-VUWS-1 UWS job document implicitly V1.0
I-UWS-POPA-4 POSTed PHASE=RUN to http://localhost:8080/firethorn/tap/376723/async/517415/phase

Section MDQ: Check table query result columns against declared metadata
I-MDQ-QSUB-1 Submitting query: SELECT TOP 1 * FROM "FIRST".first08Jul16Source
I-MDQ-QSUB-2 Submitting query: SELECT TOP 1 * FROM "FIRST".firstSource
I-MDQ-QSUB-3 Submitting query: SELECT TOP 1 * FROM "FIRST".firstSource12Feb16
I-MDQ-QSUB-4 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ArchiveCurationHistory
I-MDQ-QSUB-5 Submitting query: SELECT TOP 1 * FROM ATLASDR1.AstrCalVers
I-MDQ-QSUB-6 Submitting query: SELECT TOP 1 * FROM ATLASDR1.CurationTask
I-MDQ-QSUB-7 Submitting query: SELECT TOP 1 * FROM ATLASDR1.CurrentAstrometry
I-MDQ-QSUB-8 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ExternalSurvey
I-MDQ-QSUB-9 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ExternalSurveyTable
c^C^C^C^C^C[Stevedore@Cadelicia ~]$ ^C
[Stevedore@Cadelicia ~]$ ^C
[Stevedore@Cadelicia ~]$ ^C
[Stevedore@Cadelicia ~]$ ^C
[Stevedore@Cadelicia ~]$ ^C
[Stevedore@Cadelicia ~]$ java -jar stilts.jar taplint tapurl=http://localhost:8080/firethorn/tap/376723/  debug=true
This is STILTS taplint, 3.2/1c07f08 (2019-11-18)
Static report types: ERROR(139), WARNING(56), INFO(23), SUMMARY(9), FAILURE(22)

Section TMV: Validate table metadata against XML schema
I-TMV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/tables as tableset (http://www.ivoa.net/xml/VODataService/v1.1)
S-TMV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section TME: Check content of tables metadata from /tables
I-TME-CURL-1 Reading capability metadata from http://localhost:8080/firethorn/tap/376723/capabilities
I-TME-TURL-1 Reading table metadata from http://localhost:8080/firethorn/tap/376723/tables
S-TME-SUMM-1 Schemas: 17, Tables: 739, Columns: 31211, Foreign Keys: 0
S-TME-FLGS-1 Standard column flags: indexed: 0, primary: 0, nullable: 0
S-TME-FLGO-1 Other column flags: none

Section TMS: Check content of tables metadata from TAP_SCHEMA
I-TMS-TAPV-1 Validating for TAP version V1.0
I-TMS-QSUB-1 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.schemas
I-TMS-QGET-1 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.schemas
I-TMS-QSUB-2 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.tables
I-TMS-QGET-2 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.tables
I-TMS-QSUB-3 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.columns
I-TMS-QGET-3 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.columns
I-TMS-QSUB-4 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.keys
I-TMS-QGET-4 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.keys
I-TMS-QSUB-5 Submitting query: SELECT COUNT(*) AS nr FROM TAP_SCHEMA.key_columns
I-TMS-QGET-5 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+COUNT%28*%29+AS+nr+FROM+TAP_SCHEMA.key_columns
I-TMS-QSUB-6 Submitting query: SELECT principal, indexed, std, "size" FROM TAP_SCHEMA.columns
I-TMS-QGET-6 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+principal%2C+indexed%2C+std%2C+%22size%22+FROM+TAP_SCHEMA.columns&MAXREC=31221
I-TMS-QSUB-7 Submitting query: SELECT TOP 1 * FROM TAP_SCHEMA.columns
I-TMS-QGET-7 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+1+*+FROM+TAP_SCHEMA.columns&MAXREC=1
I-TMS-QSUB-8 Submitting query: SELECT ft_column_id, std, indexed, principal, arraysize, ts_column_id, datatype, utype, ucd, unit, description, column_name, table_name FROM TAP_SCHEMA.columns
I-TMS-QGET-8 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+ft_column_id%2C+std%2C+indexed%2C+principal%2C+arraysize%2C+ts_column_id%2C+datatype%2C+utype%2C+ucd%2C+unit%2C+description%2C+column_name%2C+table_name+FROM+TAP_SCHEMA.columns&MAXREC=31221
I-TMS-QSUB-9 Submitting query: SELECT from_column, target_column, key_id FROM TAP_SCHEMA.key_columns
I-TMS-QGET-9 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+from_column%2C+target_column%2C+key_id+FROM+TAP_SCHEMA.key_columns&MAXREC=31221
E-TMS-TSCT-1 Type mismatch for column TAP_SCHEMA.schemas.schema_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-2 Type mismatch for column TAP_SCHEMA.schemas.utype: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-3 Type mismatch for column TAP_SCHEMA.schemas.description: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-1 2 non-standard columns in TAP_SCHEMA.schemas: [ts_schema_id, ft_schema_id]
E-TMS-TSCT-4 Type mismatch for column TAP_SCHEMA.tables.schema_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-5 Type mismatch for column TAP_SCHEMA.tables.table_name: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-6 Type mismatch for column TAP_SCHEMA.tables.table_type: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-7 Type mismatch for column TAP_SCHEMA.tables.utype: datatype=char is not varchar-like (TAP 1.0)
E-TMS-TSCT-8 Type mismatch for column TAP_SCHEMA.tables.description: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-2 2 non-standard columns in TAP_SCHEMA.tables: [ts_table_id, ft_table_id]
E-TMS-TSCT-9 Type mismatch for column TAP_SCHEMA.columns.table_name: datatype=char is not varchar-like (TAP 1.0)
I-TMS-TSNS-3 3 non-standard columns in TAP_SCHEMA.columns: [arraysize, ts_column_id, ft_column_id]
I-TMS-TSNS-4 1 non-standard columns in TAP_SCHEMA.keys: [ts_key_id]
I-TMS-TSNS-5 1 non-standard columns in TAP_SCHEMA.key_columns: [ts_key_column_id]
S-TMS-SUMM-1 Schemas: 17, Tables: 739, Columns: 31211, Foreign Keys: 0
S-TMS-FLGS-1 Standard column flags: indexed: 0, principal: 7, std: 33
S-TMS-QNUM-1 Successful/submitted TAP queries: 29/29
S-TMS-QTIM-1 Average successful query time: 1.4s
I-TMS-QSUB-x (20 more)
I-TMS-QGET-x (20 more)
E-TMS-TSCT-x (18 more)

Section TMC: Compare table metadata from /tables and TAP_SCHEMA

Section CPV: Validate capabilities against XML schema
I-CPV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/capabilities as capabilities (http://www.ivoa.net/xml/VOSICapabilities/v1.0)
S-CPV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section CAP: Check TAP and TAPRegExt content of capabilities document

Section AVV: Validate availability against XML schema
I-AVV-VURL-1 Validating http://localhost:8080/firethorn/tap/376723/availability as availability (http://www.ivoa.net/xml/VOSIAvailability/v1.0)
S-AVV-VALI-1 SAX report: warnings 0, errors 0, fatal 0

Section QGE: Make ADQL queries in sync GET mode
I-QGE-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-1 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+10+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-2 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+programmeID+FROM+VPHASDR3.RequiredFilters&MAXREC=9
I-QGE-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-3 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+10+programmeID+FROM+VPHASDR3.RequiredFilters&DUMMY=ignore-me
I-QGE-QSUB-4 Submitting query: SELECT TOP 1 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-4 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL-2.0&QUERY=SELECT+TOP+1+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-5 Submitting query: SELECT TOP 1 programmeID FROM VPHASDR3.RequiredFilters
I-QGE-QGET-5 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+1+programmeID+FROM+VPHASDR3.RequiredFilters
I-QGE-QSUB-6 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QGE-QGET-6 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+TOP+8+aperture%2C+transFile+AS+taplint_c_2%2C+V.surveyID%2C+tableID+AS+taplint_c_4%2C+programmeID++FROM+VPHASDR3.RequiredListDrivenProduct+AS+V
I-QGE-QSUB-7 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QGE-QGET-7 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=SELECT+fieldID+FROM+VPHASDR3.StdFieldInfo&MAXREC=0
I-QGE-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QGE-QGET-8 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=ADQL&QUERY=DUFF+QUERY
I-QGE-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
I-QGE-QGET-9 Query GET URL: http://localhost:8080/firethorn/tap/376723/sync?REQUEST=doQuery&LANG=OOBLECK&QUERY=SELECT+TOP+1+*+FROM+TAP_SCHEMA.tables
S-QGE-QNUM-1 Successful/submitted TAP queries: 7/7
S-QGE-QTIM-1 Average successful query time: 1.0s

Section QPO: Make ADQL queries in sync POST mode
I-QPO-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QPO-QSUB-4 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QPO-QSUB-5 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QPO-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QPO-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
S-QPO-QNUM-1 Successful/submitted TAP queries: 5/5
S-QPO-QTIM-1 Average successful query time: 1.1s

Section QAS: Make ADQL queries in async mode
I-QAS-QSUB-1 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-1 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567745
I-QAS-QSUB-2 Submitting query: SELECT programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-2 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567746
E-QAS-OVNO-1 Overflow not marked - no <INFO name='QUERY_STATUS' value='OVERFLOW'/> after TABLE
I-QAS-QSUB-3 Submitting query: SELECT TOP 10 programmeID FROM VPHASDR3.RequiredFilters
I-QAS-QJOB-3 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567747
I-QAS-QSUB-4 Submitting query: SELECT TOP 8 aperture, transFile AS taplint_c_2, V.surveyID, tableID AS taplint_c_4, programmeID FROM VPHASDR3.RequiredListDrivenProduct AS V
I-QAS-QJOB-4 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567748
I-QAS-QSUB-5 Submitting query: SELECT fieldID FROM VPHASDR3.StdFieldInfo
I-QAS-QJOB-5 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567749
I-QAS-DUFF-1 Submitting query expected to fail (bad ADQL): DUFF QUERY
I-QAS-QJOB-6 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567750
I-QAS-DUFF-2 Submitting query expected to fail (unknown query language): SELECT TOP 1 * FROM TAP_SCHEMA.tables
I-QAS-QJOB-7 Submitted query at http://localhost:8080/firethorn/tap/376723/async/567751
E-QAS-DSUC-1 Apparent success from bad query (unknown query language)
S-QAS-QNUM-1 Successful/submitted TAP queries: 5/5
S-QAS-QTIM-1 Average successful query time: 1.4s

Section UWS: Test asynchronous UWS/TAP behaviour
I-UWS-CJOB-1 Created new job http://localhost:8080/firethorn/tap/376723/async/569102
I-UWS-POPA-1 POSTed runId=TAPLINT-002 to http://localhost:8080/firethorn/tap/376723/async/569102/parameters
I-UWS-POPA-2 POSTed PHASE=ABORT to http://localhost:8080/firethorn/tap/376723/async/569102/phase
I-UWS-POPA-3 POSTed ACTION=DELETE to http://localhost:8080/firethorn/tap/376723/async/569102
I-UWS-CJOB-2 Created new job http://localhost:8080/firethorn/tap/376723/async/569103
I-UWS-CJOB-3 Created new job http://localhost:8080/firethorn/tap/376723/async/569104
I-UWS-VUWS-1 UWS job document implicitly V1.0
I-UWS-POPA-4 POSTed PHASE=RUN to http://localhost:8080/firethorn/tap/376723/async/569104/phase

Section MDQ: Check table query result columns against declared metadata
I-MDQ-QSUB-1 Submitting query: SELECT TOP 1 * FROM "FIRST".first08Jul16Source
I-MDQ-QSUB-2 Submitting query: SELECT TOP 1 * FROM "FIRST".firstSource
I-MDQ-QSUB-3 Submitting query: SELECT TOP 1 * FROM "FIRST".firstSource12Feb16
I-MDQ-QSUB-4 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ArchiveCurationHistory
I-MDQ-QSUB-5 Submitting query: SELECT TOP 1 * FROM ATLASDR1.AstrCalVers
I-MDQ-QSUB-6 Submitting query: SELECT TOP 1 * FROM ATLASDR1.CurationTask
I-MDQ-QSUB-7 Submitting query: SELECT TOP 1 * FROM ATLASDR1.CurrentAstrometry
I-MDQ-QSUB-8 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ExternalSurvey
I-MDQ-QSUB-9 Submitting query: SELECT TOP 1 * FROM ATLASDR1.ExternalSurveyTable
S-MDQ-QNUM-1 Successful/submitted TAP queries: 739/739
S-MDQ-QTIM-1 Average successful query time: 1.4s
I-MDQ-QSUB-x (730 more)

Section OBS: Test implementation of ObsCore Data Model
I-OBS-NODM-1 Table capabilities lists no ObsCore DataModel - no ObsCore tests

Section UPL: Make queries with table uploads
F-UPL-NOUP-1 Table capabilities lists no upload methods - will not attempt upload tests

Section EXA: Check content of examples document
I-EXA-EURL-1 Reading examples document from http://localhost:8080/firethorn/tap/376723/examples
F-EXA-EXNO-1 No examples document at http://localhost:8080/firethorn/tap/376723/examples

Totals: Errors: 29; Warnings: 0; Infos: 857; Summaries: 18; Failures: 2


## Some (unrelated errors), issue for them created in Redmine (http://redmine.roe.ac.uk/issues/1183)

